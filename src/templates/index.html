{% extends "base.html" %}

{% block head_extra %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "{{ site_name }}",
    "url": "{{ site_url }}",
    "description": "{{ site_description }}",
    "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ site_url }}/?q={search_term_string}",
        "query-input": "required name=search_term_string"
    }
}
</script>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero" id="hero">
    <div class="hero-bg"></div>
    <div class="container hero-content">
        <h1 class="hero-title">
            Discover <span class="gradient-text">Free &amp; Open APIs</span>
        </h1>
        <p class="hero-subtitle">
            Browse <strong>{{ total_apis }}+</strong> curated APIs across
            <strong>{{ total_categories }}</strong> categories.
            Always free. Always up-to-date.
        </p>

        <!-- Search Bar -->
        <div class="search-wrapper" id="search-wrapper">
            <div class="search-bar">
                <span class="search-icon">üîç</span>
                <input type="search" id="hero-search" class="search-input"
                    placeholder="Search APIs... (e.g. weather, music, finance)" autocomplete="off"
                    aria-label="Search APIs">
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-row">
            <div class="stat-item">
                <span class="stat-number" id="stat-apis">{{ total_apis }}</span>
                <span class="stat-label">Free APIs</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="stat-categories">{{ total_categories }}</span>
                <span class="stat-label">Categories</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">100%</span>
                <span class="stat-label">Free</span>
            </div>
        </div>
    </div>
</section>

<!-- Category Cards -->
<section class="categories-section" id="categories">
    <div class="container">
        <h2 class="section-title">Browse by Category</h2>
        <p class="section-subtitle">Find the perfect API for your next project</p>

        <div class="category-grid" id="category-grid">
            {% for cat in categories %}
            <a href="/category/{{ cat.slug }}.html" class="category-card" id="cat-{{ cat.slug }}">
                <div class="category-card-inner">
                    <h3 class="category-name">{{ cat.name }}</h3>
                    <span class="category-count">{{ cat.count }} API{{ 's' if cat.count != 1 }}</span>
                </div>
                <span class="category-arrow">‚Üí</span>
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured APIs -->
<section class="featured-section" id="featured">
    <div class="container">
        <h2 class="section-title">Featured APIs</h2>
        <p class="section-subtitle">Popular and trending APIs to get you started</p>

        <div class="items-grid" id="featured-grid">
            {% for item in featured_items %}
            <a href="/api/{{ item.slug }}.html" class="item-card" id="item-{{ item.slug }}">
                <div class="item-card-header">
                    <h3 class="item-title">{{ item.title }}</h3>
                    <span class="item-category-badge">{{ item.category }}</span>
                </div>
                <p class="item-desc">{{ item.description | truncate_text }}</p>
                <div class="item-meta">
                    <span class="meta-badge {% if item.auth == 'None' %}badge-free{% else %}badge-auth{% endif %}">
                        {{ 'üîì No Auth' if item.auth == 'None' else 'üîê ' + item.auth }}
                    </span>
                    <span class="meta-badge {% if item.https %}badge-https{% else %}badge-http{% endif %}">
                        {{ 'üîí HTTPS' if item.https else '‚ö†Ô∏è HTTP' }}
                    </span>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Ad Unit (Below Featured) -->
<section class="ad-section">
    <div class="container">
        <ins class="adsbygoogle" style="display:block" data-ad-client="{{ adsense_publisher_id }}"
            data-ad-slot="XXXXXXXXXX" data-ad-format="auto" data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section" id="cta">
    <div class="container">
        <div class="cta-card">
            <h2>Got an API?</h2>
            <p>Submit your API to be featured in our directory and reach thousands of developers.</p>
            <a href="https://yourname.gumroad.com/l/submit" class="btn btn-primary" id="cta-submit-btn" target="_blank"
                rel="noopener">
                üì§ Submit Your API
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts_extra %}
<script>
    // Client-side search redirect to category/item pages
    document.getElementById('hero-search').addEventListener('keydown', function (e) {
        if (e.key === 'Enter' && this.value.trim()) {
            // Simple client-side filter - redirect to Google site search
            const query = encodeURIComponent(this.value.trim());
            window.location.href = 'https://www.google.com/search?q=site:' + encodeURIComponent('{{ site_url }}') + '+' + query;
        }
    });
</script>
{% endblock %}